import{createStore}from"/js/AlpineStore.js";import{toggleCssProperty}from"/js/css.js";const model={settings:{},async init(){try{this.settings=JSON.parse(localStorage.getItem("messageResizeSettings")||"null")||this._getDefaultSettings()}catch(t){this.settings=this._getDefaultSettings()}this._applyAllSettings()},_getDefaultSettings:()=>({message:{minimized:!1,maximized:!1},"message-agent":{minimized:!0,maximized:!1},"message-agent-response":{minimized:!1,maximized:!0}}),getSetting(t){return this.settings[t]||{minimized:!1,maximized:!1}},_getDefaultSetting:()=>({minimized:!1,maximized:!1}),_setSetting(t,e){this.settings[t]=e;try{localStorage.setItem("messageResizeSettings",JSON.stringify(this.settings))}catch(t){}},_applyAllSettings(){for(const[t,e]of Object.entries(this.settings))this._applySetting(t,e)},async minimizeMessageClass(t,e){const i=this.getSetting(t);i.minimized=!i.minimized,this._setSetting(t,i),this._applySetting(t,i),this._applyScroll(e)},async maximizeMessageClass(t,e){const i=this.getSetting(t);if(i.minimized)return this.minimizeMessageClass(t,e);i.maximized=!i.maximized,this._setSetting(t,i),this._applySetting(t,i),this._applyScroll(e)},_applyScroll(t){if(!t||!t.target)return;const e=t.target,i=t.clientY;try{const t=e.getBoundingClientRect(),s=(window.innerHeight||document.documentElement.clientHeight,document.getElementById("chat-history"));if(!s)return;const n=s.getBoundingClientRect(),g=t.height,m=t.top+g/2-n.top;let o;if("number"==typeof i){const t=i-n.top;o=s.scrollTop+m-t}else{const t=.5*s.clientHeight;o=s.scrollTop+m-t}s.scrollTo({top:o,behavior:"auto"})}catch(t){}},_applySetting(t,e){toggleCssProperty(`.${t} .message-body`,"max-height",e.maximized?"unset":"30em"),toggleCssProperty(`.${t} .message-body`,"overflow-y",e.maximized?"hidden":"auto"),toggleCssProperty(`.${t} .message-body`,"display",e.minimized?"none":"block")}},store=createStore("messageResize",model);export{store};