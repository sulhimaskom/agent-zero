<html>

<head>
    <title>Drag Drop Overlay</title>

    <script type="module">
        import { store } from "/components/chat/attachments/attachmentsStore.min.js";
    </script>
</head>

<body>
    <!-- Drag and Drop Overlay -->
    <div x-data>
        <template x-if="$store.chatAttachments">
            <div x-cloak x-show="$store.chatAttachments.dragDropOverlayVisible" id="dragdrop-overlay"
                x-transition:enter="dragdrop-enter"
                x-transition:enter-start="dragdrop-enter-start"
                x-transition:enter-end="dragdrop-enter-end"
                x-transition:leave="dragdrop-leave"
                x-transition:leave-start="dragdrop-leave-start"
                x-transition:leave-end="dragdrop-leave-end"
                class="dragdrop-overlay"
                role="dialog"
                aria-modal="true"
                aria-label="File drop zone">

                <!-- Animated background gradient -->
                <div class="dragdrop-bg-gradient" aria-hidden="true"></div>

                <!-- Animated border effect -->
                <div class="dragdrop-border-container" aria-hidden="true">
                    <div class="dragdrop-border"></div>
                </div>

                <!-- Main content container -->
                <div class="dragdrop-content">
                    <!-- Floating icon with animation -->
                    <div class="dragdrop-icon-wrapper" aria-hidden="true">
                        <div class="dragdrop-icon-glow"></div>
                        <img src="public/dragndrop.svg" alt="Drag and drop files" class="dragdrop-icon" width="80" height="80" loading="eager">
                        <!-- Floating particles -->
                        <div class="dragdrop-particles">
                            <span class="particle particle-1"></span>
                            <span class="particle particle-2"></span>
                            <span class="particle particle-3"></span>
                        </div>
                    </div>

                    <!-- File count badge (shows when files are being dragged) -->
                    <div class="dragdrop-file-count" x-show="$store.chatAttachments.dragFileCount > 0"
                         x-transition:enter="count-enter"
                         x-transition:enter-start="count-enter-start"
                         x-transition:enter-end="count-enter-end"
                         x-transition:leave="count-leave"
                         x-transition:leave-start="count-leave-start"
                         x-transition:leave-end="count-leave-end">
                        <span class="file-count-number" x-text="$store.chatAttachments.dragFileCount"></span>
                        <span class="file-count-label" x-text="$store.chatAttachments.dragFileCount === 1 ? 'file' : 'files'"></span>
                    </div>

                    <!-- Main text -->
                    <div class="dragdrop-text-wrapper">
                        <div class="dragdrop-text">Drop files here</div>
                        <div class="dragdrop-subtext">Release to attach them to your message</div>
                    </div>

                    <!-- Supported formats hint -->
                    <div class="dragdrop-formats" aria-hidden="true">
                        <span class="format-tag">Images</span>
                        <span class="format-dot"></span>
                        <span class="format-tag">Documents</span>
                        <span class="format-dot"></span>
                        <span class="format-tag">Any file</span>
                    </div>
                </div>

                <!-- Success animation overlay (shown briefly after drop) -->
                <div class="dragdrop-success" x-show="$store.chatAttachments.showDropSuccess"
                     x-transition:enter="success-enter"
                     x-transition:enter-start="success-enter-start"
                     x-transition:enter-end="success-enter-end"
                     x-transition:leave="success-leave"
                     x-transition:leave-start="success-leave-start"
                     x-transition:leave-end="success-leave-end">
                    <div class="success-icon-wrapper">
                        <svg class="success-checkmark" viewBox="0 0 52 52" aria-hidden="true">
                            <circle class="success-circle" cx="26" cy="26" r="25" fill="none"/>
                            <path class="success-check" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8"/>
                        </svg>
                    </div>
                    <div class="success-text">Files added!</div>
                </div>
            </div>
        </template>
    </div>

    <style>
        /* ===== BASE OVERLAY STYLES ===== */
        .dragdrop-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(0, 0, 0, 0.75);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            overflow: hidden;
        }

        /* ===== ANIMATED BACKGROUND GRADIENT ===== */
        .dragdrop-bg-gradient {
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(
                ellipse at center,
                rgba(66, 72, 241, 0.15) 0%,
                rgba(66, 72, 241, 0.05) 30%,
                transparent 70%
            );
            animation: gradient-rotate 10s linear infinite;
            pointer-events: none;
        }

        @keyframes gradient-rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* ===== ANIMATED BORDER ===== */
        .dragdrop-border-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: min(400px, 80vw);
            height: min(400px, 80vw);
            border-radius: 24px;
            padding: 3px;
            background: linear-gradient(
                90deg,
                var(--color-highlight, #4248f1),
                #00d4ff,
                var(--color-highlight, #4248f1),
                #00d4ff
            );
            background-size: 300% 100%;
            animation: border-flow 3s linear infinite;
            box-shadow: 0 0 60px rgba(66, 72, 241, 0.3);
        }

        @keyframes border-flow {
            0% { background-position: 0% 50%; }
            100% { background-position: 300% 50%; }
        }

        .dragdrop-border {
            width: 100%;
            height: 100%;
            background: var(--color-panel, #2d2d2d);
            border-radius: 22px;
            position: relative;
            overflow: hidden;
        }

        .dragdrop-border::before {
            content: '';
            position: absolute;
            inset: 2px;
            border: 2px dashed var(--color-border, #444);
            border-radius: 18px;
            animation: dash-move 20s linear infinite;
        }

        @keyframes dash-move {
            0% { stroke-dashoffset: 0; }
            100% { stroke-dashoffset: 100; }
        }

        /* ===== CONTENT CONTAINER ===== */
        .dragdrop-content {
            position: relative;
            z-index: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            padding: 3rem;
            max-width: 320px;
        }

        /* ===== ICON WITH ANIMATIONS ===== */
        .dragdrop-icon-wrapper {
            position: relative;
            margin-bottom: 1.5rem;
        }

        .dragdrop-icon {
            width: 80px;
            height: 80px;
            position: relative;
            z-index: 2;
            animation: icon-float 3s ease-in-out infinite;
            filter: drop-shadow(0 10px 20px rgba(66, 72, 241, 0.3));
        }

        @keyframes icon-float {
            0%, 100% { transform: translateY(0) scale(1); }
            50% { transform: translateY(-10px) scale(1.05); }
        }

        .dragdrop-icon-glow {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 120px;
            height: 120px;
            background: radial-gradient(
                circle,
                rgba(66, 72, 241, 0.4) 0%,
                transparent 70%
            );
            border-radius: 50%;
            animation: glow-pulse 2s ease-in-out infinite;
            z-index: 1;
        }

        @keyframes glow-pulse {
            0%, 100% { opacity: 0.5; transform: translate(-50%, -50%) scale(1); }
            50% { opacity: 0.8; transform: translate(-50%, -50%) scale(1.1); }
        }

        /* ===== FLOATING PARTICLES ===== */
        .dragdrop-particles {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .particle {
            position: absolute;
            width: 6px;
            height: 6px;
            background: var(--color-highlight, #4248f1);
            border-radius: 50%;
            opacity: 0;
        }

        .particle-1 {
            top: -10px;
            left: 20%;
            animation: particle-rise 2s ease-out infinite;
        }

        .particle-2 {
            top: 20%;
            right: -10px;
            animation: particle-rise 2.5s ease-out infinite 0.5s;
        }

        .particle-3 {
            bottom: -10px;
            left: 60%;
            animation: particle-rise 2.2s ease-out infinite 1s;
        }

        @keyframes particle-rise {
            0% {
                opacity: 0;
                transform: translateY(0) scale(0);
            }
            20% {
                opacity: 1;
                transform: scale(1);
            }
            100% {
                opacity: 0;
                transform: translateY(-40px) scale(0.5);
            }
        }

        /* ===== FILE COUNT BADGE ===== */
        .dragdrop-file-count {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            background: var(--color-highlight, #4248f1);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            margin-bottom: 1rem;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(66, 72, 241, 0.4);
            animation: count-pulse 2s ease-in-out infinite;
        }

        @keyframes count-pulse {
            0%, 100% { box-shadow: 0 4px 15px rgba(66, 72, 241, 0.4); }
            50% { box-shadow: 0 4px 25px rgba(66, 72, 241, 0.6); }
        }

        .file-count-number {
            font-size: 1.2rem;
        }

        .file-count-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        /* ===== TEXT STYLES ===== */
        .dragdrop-text-wrapper {
            margin-bottom: 1.5rem;
        }

        .dragdrop-text {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--color-text, #fff);
            margin-bottom: 0.5rem;
            animation: text-shimmer 3s ease-in-out infinite;
        }

        @keyframes text-shimmer {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }

        .dragdrop-subtext {
            font-size: 0.95rem;
            color: var(--color-secondary, #888);
            opacity: 0.8;
        }

        /* ===== FORMAT TAGS ===== */
        .dragdrop-formats {
            display: flex;
            align-items: center;
            gap: 8px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .format-tag {
            font-size: 0.75rem;
            padding: 4px 10px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--color-border, #444);
            border-radius: 12px;
            color: var(--color-secondary, #888);
        }

        .format-dot {
            width: 4px;
            height: 4px;
            background: var(--color-highlight, #4248f1);
            border-radius: 50%;
            opacity: 0.5;
        }

        /* ===== SUCCESS OVERLAY ===== */
        .dragdrop-success {
            position: absolute;
            inset: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            z-index: 10;
        }

        .success-icon-wrapper {
            margin-bottom: 1rem;
        }

        .success-checkmark {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: block;
        }

        .success-circle {
            stroke: #4CAF50;
            stroke-width: 3;
            stroke-dasharray: 166;
            stroke-dashoffset: 166;
            animation: stroke 0.6s cubic-bezier(0.65, 0, 0.45, 1) forwards;
        }

        .success-check {
            stroke: #4CAF50;
            stroke-width: 3;
            stroke-dasharray: 48;
            stroke-dashoffset: 48;
            animation: stroke 0.3s cubic-bezier(0.65, 0, 0.45, 1) 0.6s forwards;
        }

        @keyframes stroke {
            100% { stroke-dashoffset: 0; }
        }

        .success-text {
            font-size: 1.2rem;
            font-weight: 600;
            color: #4CAF50;
            animation: success-fade-in 0.5s ease 0.8s both;
        }

        @keyframes success-fade-in {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ===== TRANSITION ANIMATIONS ===== */
        /* Main overlay transitions */
        .dragdrop-enter { transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55); }
        .dragdrop-enter-start { opacity: 0; transform: scale(0.9); }
        .dragdrop-enter-end { opacity: 1; transform: scale(1); }

        .dragdrop-leave { transition: all 0.3s ease; }
        .dragdrop-leave-start { opacity: 1; transform: scale(1); }
        .dragdrop-leave-end { opacity: 0; transform: scale(0.95); }

        /* File count transitions */
        .count-enter { transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55); }
        .count-enter-start { opacity: 0; transform: scale(0.5) translateY(-10px); }
        .count-enter-end { opacity: 1; transform: scale(1) translateY(0); }

        .count-leave { transition: all 0.2s ease; }
        .count-leave-start { opacity: 1; transform: scale(1); }
        .count-leave-end { opacity: 0; transform: scale(0.8); }

        /* Success transitions */
        .success-enter { transition: all 0.3s ease; }
        .success-enter-start { opacity: 0; }
        .success-enter-end { opacity: 1; }

        .success-leave { transition: all 0.2s ease; }
        .success-leave-start { opacity: 1; }
        .success-leave-end { opacity: 0; }

        /* ===== LIGHT MODE ADJUSTMENTS ===== */
        .light-mode .dragdrop-overlay {
            background: rgba(0, 0, 0, 0.6);
        }

        .light-mode .dragdrop-border {
            background: #ffffff;
        }

        .light-mode .dragdrop-text {
            color: #2d2d2d;
        }

        .light-mode .format-tag {
            background: rgba(0, 0, 0, 0.05);
            color: #666;
        }

        .light-mode .dragdrop-success {
            background: rgba(255, 255, 255, 0.95);
        }

        /* ===== ACCESSIBILITY: REDUCED MOTION ===== */
        @media (prefers-reduced-motion: reduce) {
            .dragdrop-bg-gradient,
            .dragdrop-border-container,
            .dragdrop-icon,
            .dragdrop-icon-glow,
            .particle,
            .dragdrop-file-count,
            .dragdrop-text,
            .success-circle,
            .success-check,
            .success-text {
                animation: none;
            }

            .dragdrop-enter,
            .dragdrop-leave,
            .count-enter,
            .count-leave,
            .success-enter,
            .success-leave {
                transition: opacity 0.2s ease;
            }
        }

        /* ===== MOBILE ADJUSTMENTS ===== */
        @media (max-width: 768px) {
            .dragdrop-border-container {
                width: min(320px, 85vw);
                height: min(320px, 85vw);
            }

            .dragdrop-content {
                padding: 2rem;
            }

            .dragdrop-icon {
                width: 60px;
                height: 60px;
            }

            .dragdrop-icon-glow {
                width: 90px;
                height: 90px;
            }

            .dragdrop-text {
                font-size: 1.2rem;
            }

            .dragdrop-subtext {
                font-size: 0.85rem;
            }
        }
    </style>
</body>

</html>