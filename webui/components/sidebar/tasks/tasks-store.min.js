import{createStore}from"/js/AlpineStore.js";import{store as chatsStore}from"/components/sidebar/chats/chats-store.js";const model={tasks:[],selected:"",isLoading:!0,init(){},applyTasks(s){try{const t=[...Array.isArray(s)?s:[]].sort((s,t)=>(t?.created_at||0)-(s?.created_at||0));this.tasks=t,this.selected&&!this.contains(this.selected)&&this.setSelected(""),this.isLoading=!1}catch(s){console.error("tasks-store.applyTasks failed",s),this.tasks=[],this.isLoading=!1}},setSelected(s){this.selected=s||"";try{localStorage.setItem("lastSelectedTask",this.selected)}catch{}},contains(s){return Array.isArray(this.tasks)&&this.tasks.some(t=>t?.id===s)},firstId(){return Array.isArray(this.tasks)&&this.tasks[0]?.id||""},selectTask(s){this.setSelected(s),chatsStore.selectChat(s)},openDetail(s){globalThis.openTaskDetail&&globalThis.openTaskDetail(s)},reset(s){chatsStore.resetChat(s)},deleteTask(s){globalThis.deleteTaskGlobal&&globalThis.deleteTaskGlobal(s)}};export const store=createStore("tasks",model);