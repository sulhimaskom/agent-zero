<html>
<head>
  <script type="module">
    import { store } from "/components/sidebar/bottom/preferences/preferences-store.min.js";
  </script>
</head>
<body>
  <div x-data>
    <template x-if="$store.preferences">
      <div class="pref-section">
        <span>
          <h3 class="pref-header"
              data-bs-toggle="collapse"
              @click="$store.sidebar.toggleSection('preferences')"
              x-effect="!$store.sidebar.isSectionOpen('preferences') ? $el.classList.add('collapsed') : $el.classList.remove('collapsed')">
            Preferences
            <svg class="arrow-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
              <path d="M8 4l8 8-8 8" />
            </svg>
          </h3>
          <ul class="config-list collapse" id="preferences-collapse"
              x-effect="(() => { const c = bootstrap.Collapse.getOrCreateInstance($el, { toggle: false }); $store.sidebar.isSectionOpen('preferences') ? c.show() : c.hide(); })()">
            <li x-data>
              <span>Autoscroll</span>
              <label class="switch">
                <input id="auto-scroll-switch" type="checkbox" x-model="$store.preferences.autoScroll" aria-label="Autoscroll">
                <span class="slider"></span>
              </label>
            </li>
            <li x-data>
              <span class="switch-label">Dark mode</span>
              <label class="switch">
                <input id="dark-mode-switch" type="checkbox" x-model="$store.preferences.darkMode" aria-label="Dark mode">
                <span class="slider"></span>
              </label>
            </li>
            <li x-data>
              <span class="switch-label">Speech</span>
              <label class="switch">
                <input id="speech-switch" type="checkbox" x-model="$store.preferences.speech" aria-label="Speech">
                <span class="slider"></span>
              </label>
            </li>
            <li x-data>
              <span>Show thoughts</span>
              <label class="switch">
                <input id="show-thoughts-switch" type="checkbox" x-model="$store.preferences.showThoughts" aria-label="Show thoughts">
                <span class="slider"></span>
              </label>
            </li>
            <li x-data>
              <span>Show JSON</span>
              <label class="switch">
                <input id="show-json-switch" type="checkbox" x-model="$store.preferences.showJson" aria-label="Show JSON">
                <span class="slider"></span>
              </label>
            </li>
            <li x-data>
              <span>Show utility messages</span>
              <label class="switch">
                <input id="show-utils-switch" type="checkbox" x-model="$store.preferences.showUtils" aria-label="Show utility messages">
                <span class="slider"></span>
              </label>
            </li>
          </ul>
        </span>
      </div>
    </template>
  </div>

  <style>
    .pref-section {
    font-size: var(--font-size-small);
    padding: 0.6rem var(--spacing-md) 0.05rem var(--spacing-md);
    }
    /* Collapse transition */
    .pref-section [x-cloak] {
      display: none;
    }
    .pref-section .pref-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 6px;
      cursor: pointer;
      user-select: none;
    }
    .pref-section .config-list {
      list-style: none;
      padding: 0.05rem 0;
      margin: 0;
      display: flex;
      flex-direction: column;
      gap: 1px;
    }
    #preferences-collapse li {
    opacity: 0.8;
    }
    .pref-section .switch-label,
    .pref-section span {
      font-size: 0.8rem;
    }
    .pref-section .switch {
      position: relative;
      display: inline-block;
      width: 35px;
      height: 19px;
      margin-left: auto;
    }
    .pref-section li { display: flex; align-items: center; }

    /* ============================================
       ENHANCED TOGGLE SWITCH MICRO-INTERACTIONS
       Satisfying snap animation with visual feedback
       ============================================ */

    /* Base switch enhancement */
    .pref-section .slider {
      transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
      position: relative;
      overflow: visible;
    }

    /* The toggle knob */
    .pref-section .slider:before {
      transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }

    /* Checked state - enhanced visual feedback */
    .pref-section input:checked + .slider {
      background-color: var(--color-highlight);
      box-shadow: 0 0 8px rgba(66, 72, 241, 0.4);
    }

    /* Light mode adjustment for checked state */
    .light-mode .pref-section input:checked + .slider {
      box-shadow: 0 0 8px rgba(66, 72, 241, 0.3);
    }

    /* Knob position when checked with enhanced animation */
    .pref-section input:checked + .slider:before {
      transform: translateX(16px) scale(1.05);
      background-color: #ffffff;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
    }

    /* Hover state for enhanced interactivity */
    .pref-section .switch:hover .slider {
      box-shadow: 0 0 0 3px rgba(66, 72, 241, 0.15);
    }

    .pref-section .switch:hover input:checked + .slider {
      box-shadow: 0 0 0 3px rgba(66, 72, 241, 0.25),
                  0 0 8px rgba(66, 72, 241, 0.4);
    }

    /* Active/click state for tactile feedback */
    .pref-section .switch:active .slider:before {
      transform: scale(0.95);
    }

    .pref-section .switch:active input:checked + .slider:before {
      transform: translateX(16px) scale(0.9);
    }

    /* Focus visible for accessibility */
    .pref-section .switch input:focus-visible + .slider {
      outline: 2px solid var(--color-highlight);
      outline-offset: 2px;
    }

    /* Toggle "snap" animation keyframes */
    @keyframes toggle-snap-on {
      0% {
        transform: translateX(0) scale(1);
      }
      40% {
        transform: translateX(18px) scale(1.15);
      }
      70% {
        transform: translateX(14px) scale(0.95);
      }
      100% {
        transform: translateX(16px) scale(1.05);
      }
    }

    @keyframes toggle-snap-off {
      0% {
        transform: translateX(16px) scale(1.05);
      }
      40% {
        transform: translateX(-2px) scale(1.15);
      }
      70% {
        transform: translateX(2px) scale(0.95);
      }
      100% {
        transform: translateX(0) scale(1);
      }
    }

    /* Apply snap animation on toggle */
    .pref-section .switch input:checked + .slider:before {
      animation: toggle-snap-on 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55) forwards;
    }

    .pref-section .switch input:not(:checked) + .slider:before {
      animation: toggle-snap-off 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55) forwards;
    }

    /* Glow pulse effect when toggled */
    @keyframes toggle-glow {
      0%, 100% {
        box-shadow: 0 0 8px rgba(66, 72, 241, 0.4);
      }
      50% {
        box-shadow: 0 0 16px rgba(66, 72, 241, 0.6),
                    0 0 24px rgba(66, 72, 241, 0.3);
      }
    }

    .pref-section input:checked + .slider {
      animation: toggle-glow 0.6s ease-out;
    }

    /* Label highlight on toggle */
    .pref-section li:has(input:checked) span {
      color: var(--color-highlight);
      font-weight: 500;
      transition: color 0.2s ease;
    }

    /* Light mode label adjustment */
    .light-mode .pref-section li:has(input:checked) span {
      color: var(--color-highlight);
    }

    /* Accessibility: Respect reduced motion preferences */
    @media (prefers-reduced-motion: reduce) {
      .pref-section .slider,
      .pref-section .slider:before {
        transition: none;
        animation: none !important;
      }

      .pref-section input:checked + .slider:before {
        transform: translateX(16px);
        animation: none;
      }

      .pref-section input:not(:checked) + .slider:before {
        transform: translateX(0);
        animation: none;
      }

      .pref-section input:checked + .slider {
        animation: none;
      }
    }
  </style>
</body>
</html>


